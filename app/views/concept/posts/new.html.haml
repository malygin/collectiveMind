.row
  .col-md-12
    .divider10
    = render partial: 'shared/create_success', locals: { model_name: 'concept' }

    = form_for @concept_post, url: { project: @project.id, action: @concept_post.persisted? ? 'update' : 'create' }, remote: true do |f|
      .content_window.white
        %a.theme_font_color.with_arrow.collapser_type1#open_fields{ 'aria-expanded' => 'false', 'data-toggle' => 'collapse', href: '#imperfs1' }
          %span.enter_length.bold Создать идею
          %i.fa.fa-chevron-circle-right.fa-lg.fa-rotate-90.collapse_arrow{ title: 'Свернуть' }
        .collapse.in.rotate_arrow#imperfs1
          .divider_1_grey
          .divider25
          %p
            = t('activerecord.attributes.concept/post.title')
          = f.text_area :title, class: 'form-control', rows: 1
          .divider15
          %p
            = t('activerecord.attributes.concept/post.goal')
          = f.text_area :goal, class: 'form-control', rows: 2
          .divider15
          -#%p
          -#  = t('activerecord.attributes.concept/post.content')
          -#= f.text_area :content, class: 'form-control', rows: 2
          -#.divider15
          %p
            = t('activerecord.attributes.concept/post.actors')
          = f.text_area :actors, class: 'form-control', rows: 1
          .divider15
          %p
            = t('activerecord.attributes.concept/post.impact_env')
          = f.text_area :impact_env, class: 'form-control', rows: 1
          .divider15
          %p
            = f.submit t("form.#{action_name}"), class: 'btn add-button type2 pull-right middle', id: 'send_post_concept', 'data-placement' => 'top',
            'data-toggle' => 'tooltip', title: "Идею всегда можно доработать в разделе 'контент' "
            - if @concept_post.persisted? && !@concept_post.published?
              = link_to 'Опубликовать', publish_concept_post_path(@project, @concept_post), remote: true, method: :put,
              id: "publish_#{@concept_post.id}", class: 'btn add-button type2'

          .divider15
          .check_push_cont.checked_items
            %p.enter_length
              Устраняемые несовершенства
              %span.ch_lenght
                - if @concept_post.persisted?
                  = "(#{@concept_post.concept_disposts.count})"
                -else
                  (0)
            - if @concept_post.persisted?
              = render partial: 'discontent', collection: @concept_post.concept_disposts
          .divider15
    .content_window.white
      %a.theme_font_color.with_arrow.collapser_type1#open_discontents{ 'aria-expanded' => 'false', 'data-toggle' => 'collapse', href: '#imperfs2' }
        %span.enter_length.bold
          Привязать идею к несовершенству
          %span.unch_lenght
        %i.fa.fa-chevron-circle-right.fa-lg.collapse_arrow.fa-rotate-90{ title: 'Свернуть' }
      .collapse.in.check_push_cont.rotate_arrow#imperfs2
        -#= render partial: 'discontent', collection: @discontent_posts
        .divider_1_grey
        %h6 Выберите несовершенства, которые устраняются вашей идеей
        .row
          .col-md-5.cab_cont_h450
            .ps_cont
              .divider15
              = text_field_tag 'search_discontent', nil, placeholder: 'Свободный поиск', class: 'form-control', 'data-project' => @project.id
              -#%textarea.form-control{ placeholder: 'Свободный поиск', rows: '1', type: 'text' }
              .divider15
              %ul.list-unstyled.subaspect
                %li{ role: 'presentation' }
                  %a.a_font_reset.btn.btn_reset.collapser_type3.right_cursor.back_color_stage3_superpale.show_discontents{ data: { aspect: '*' },
                  'data-toggle' => 'tab', href: '#', role: 'tab' }
                    Мои несовершенства
              .divider10
              %h6 Аспекты
              - @aspects.each do |aspect|
                %a.a_font_reset.collapser_type2.with_arrow.collapsed.show_discontents{ data: { aspect: aspect.id },
                style: "background-color: #{aspect.color};", 'aria-expanded' => 'false', 'data-toggle' => 'collapse', href: "#aspect#{aspect.id}" }
                  %span
                    = aspect.content
                  %i.fa.fa-angle-right.fa-lg.collapse_arrow.font_white
                .collapse.rotate_arrow{ id: "aspect#{aspect.id}" }
                  %ul.list-unstyled.subaspect
                    - aspect.aspects.each do |asp|
                      %li{ role: 'presentation' }
                        %a.a_font_reset.btn.btn_reset.collapser_type3.show_discontents{ data: {aspect: asp.id },
                        style: "border-color: #{aspect.color};", 'data-toggle' => 'tab', href: '#', role: 'tab' }
                          = asp.content
          .col-md-7.cab_cont_h450
            .ps_cont
              .divider15
              .collapser_w_checkbox
                %span
                  %span.cb_input
                    %input#check0{ type: 'checkbox' }/
                    %label{ for: 'check0' }
                      %i.fa.fa-check
                %span
                %span.cell_full_w
                  %a.a_font_reset.with_arrow.collapser_type1{ href: '#' }
                    Выбрать все в этой группе
              .unchecked_items#unchecked_discontent_posts
                = render partial: 'discontent', collection: @discontent_posts
