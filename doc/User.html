<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: User
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!User.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (U)</a> &raquo;
    
    
    <span class="title">User</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: User
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ActiveRecord::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next">User</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="ApplicationHelper.html" title="ApplicationHelper (module)">ApplicationHelper</a></span>, PgSearch</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">app/models/user.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="VALID_EMAIL_REGEX-constant" class="">VALID_EMAIL_REGEX =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z</span><span class='regexp_end'>/i</span></span></pre></dd>
      
        <dt id="TYPES_USER-constant" class="">TYPES_USER =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
    <span class='label'>admin:</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#secret-instance_method" title="#secret (instance method)">- (Object) <strong>secret</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute secret.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#secret2-instance_method" title="#secret2 (instance method)">- (Object) <strong>secret2</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute secret2.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#secret3-instance_method" title="#secret3 (instance method)">- (Object) <strong>secret3</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute secret3.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#able_concept_posts_for_vote-instance_method" title="#able_concept_posts_for_vote (instance method)">- (Object) <strong>able_concept_posts_for_vote</strong>(project, disposts, last_vote, num = 0) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_score-instance_method" title="#add_score (instance method)">- (Object) <strong>add_score</strong>(h = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_score_by_type-instance_method" title="#add_score_by_type (instance method)">- (Object) <strong>add_score_by_type</strong>(project, score, type = :score_g) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#admin%3F-instance_method" title="#admin? (instance method)">- (Boolean) <strong>admin?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#answered_for_help_stage%3F-instance_method" title="#answered_for_help_stage? (instance method)">- (Boolean) <strong>answered_for_help_stage?</strong>(stage) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#aspects-instance_method" title="#aspects (instance method)">- (Object) <strong>aspects</strong>(id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#aspects_for_vote-instance_method" title="#aspects_for_vote (instance method)">- (Object) <strong>aspects_for_vote</strong>(project, status) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>аспекты для голосования (необходимые, важные, неважные).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#boss%3F-instance_method" title="#boss? (instance method)">- (Boolean) <strong>boss?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#can_edit_project%3F-instance_method" title="#can_edit_project? (instance method)">- (Boolean) <strong>can_edit_project?</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#can_vote_for-instance_method" title="#can_vote_for (instance method)">- (Object) <strong>can_vote_for</strong>(stage, project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cluber%3F-instance_method" title="#cluber? (instance method)">- (Boolean) <strong>cluber?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#concepts_for_vote-instance_method" title="#concepts_for_vote (instance method)">- (Object) <strong>concepts_for_vote</strong>(project, status) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>идеи для голосования (да, нет).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_for_project-instance_method" title="#content_for_project (instance method)">- (Object) <strong>content_for_project</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_projects_for_journal-instance_method" title="#current_projects_for_journal (instance method)">- (Object) <strong>current_projects_for_journal</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_projects_for_user-instance_method" title="#current_projects_for_user (instance method)">- (Object) <strong>current_projects_for_user</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#discontents_for_vote-instance_method" title="#discontents_for_vote (instance method)">- (Object) <strong>discontents_for_vote</strong>(project, status) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>несовершенства для голосования (необходимые, важные, неважные).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expert%3F-instance_method" title="#expert? (instance method)">- (Boolean) <strong>expert?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group_include_user%3F-instance_method" title="#group_include_user? (instance method)">- (Boolean) <strong>group_include_user?</strong>(user) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#have_essay_for_stage-instance_method" title="#have_essay_for_stage (instance method)">- (Object) <strong>have_essay_for_stage</strong>(project, stage) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#jury%3F-instance_method" title="#jury? (instance method)">- (Boolean) <strong>jury?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_event-instance_method" title="#last_event (instance method)">- (Object) <strong>last_event</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#looked_chat-instance_method" title="#looked_chat (instance method)">- (Object) <strong>looked_chat</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#moderator_in_project%3F-instance_method" title="#moderator_in_project? (instance method)">- (Boolean) <strong>moderator_in_project?</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#my_journals-instance_method" title="#my_journals (instance method)">- (Object) <strong>my_journals</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#my_journals_viewed-instance_method" title="#my_journals_viewed (instance method)">- (Object) <strong>my_journals_viewed</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#not_ready_for_concept%3F-instance_method" title="#not_ready_for_concept? (instance method)">- (Boolean) <strong>not_ready_for_concept?</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#novations_for_vote-instance_method" title="#novations_for_vote (instance method)">- (Object) <strong>novations_for_vote</strong>(project, status) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>пакеты для голосования (да, нет).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#plan_vote_status-instance_method" title="#plan_vote_status (instance method)">- (Object) <strong>plan_vote_status</strong>(post, type) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prime_admin%3F-instance_method" title="#prime_admin? (instance method)">- (Boolean) <strong>prime_admin?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#project_user_for-instance_method" title="#project_user_for (instance method)">- (Object) <strong>project_user_for</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#role_expert%3F-instance_method" title="#role_expert? (instance method)">- (Boolean) <strong>role_expert?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#role_name-instance_method" title="#role_name (instance method)">- (Object) <strong>role_name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stat_expert%3F-instance_method" title="#stat_expert? (instance method)">- (Boolean) <strong>stat_expert?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq_proc_access%3F-instance_method" title="#uniq_proc_access? (instance method)">- (Boolean) <strong>uniq_proc_access?</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unvote_aspects_for_vote-instance_method" title="#unvote_aspects_for_vote (instance method)">- (Object) <strong>unvote_aspects_for_vote</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>аспекты за которые пользователь еще не проголосовал.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unvote_concepts_for_vote-instance_method" title="#unvote_concepts_for_vote (instance method)">- (Object) <strong>unvote_concepts_for_vote</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>идеи за которые пользователь еще не проголосовал.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unvote_discontents_for_vote-instance_method" title="#unvote_discontents_for_vote (instance method)">- (Object) <strong>unvote_discontents_for_vote</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>несовершенства за которые пользователь еще не проголосовал.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unvote_novations_for_vote-instance_method" title="#unvote_novations_for_vote (instance method)">- (Object) <strong>unvote_novations_for_vote</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>пакеты за которые пользователь еще не проголосовал.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_project_scores-instance_method" title="#user_project_scores (instance method)">- (Object) <strong>user_project_scores</strong>(project) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_password%3F-instance_method" title="#valid_password? (instance method)">- (Boolean) <strong>valid_password?</strong>(password) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#watcher%3F-instance_method" title="#watcher? (instance method)">- (Boolean) <strong>watcher?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ApplicationHelper.html" title="ApplicationHelper (module)">ApplicationHelper</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ApplicationHelper.html#analytics%3F-instance_method" title="ApplicationHelper#analytics? (method)">#analytics?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#cabinet%3F-instance_method" title="ApplicationHelper#cabinet? (method)">#cabinet?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#can_vote%3F-instance_method" title="ApplicationHelper#can_vote? (method)">#can_vote?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#class_post_content-instance_method" title="ApplicationHelper#class_post_content (method)">#class_post_content</a></span>, <span class='object_link'><a href="ApplicationHelper.html#club_toggle_user-instance_method" title="ApplicationHelper#club_toggle_user (method)">#club_toggle_user</a></span>, <span class='object_link'><a href="ApplicationHelper.html#color_progress_bar-instance_method" title="ApplicationHelper#color_progress_bar (method)">#color_progress_bar</a></span>, <span class='object_link'><a href="ApplicationHelper.html#color_stage-instance_method" title="ApplicationHelper#color_stage (method)">#color_stage</a></span>, <span class='object_link'><a href="ApplicationHelper.html#column_for_concept_type-instance_method" title="ApplicationHelper#column_for_concept_type (method)">#column_for_concept_type</a></span>, <span class='object_link'><a href="ApplicationHelper.html#column_for_type_field-instance_method" title="ApplicationHelper#column_for_type_field (method)">#column_for_type_field</a></span>, <span class='object_link'><a href="ApplicationHelper.html#comment_stat_color-instance_method" title="ApplicationHelper#comment_stat_color (method)">#comment_stat_color</a></span>, <span class='object_link'><a href="ApplicationHelper.html#core_methods%3F-instance_method" title="ApplicationHelper#core_methods? (method)">#core_methods?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#count_available_voiting-instance_method" title="ApplicationHelper#count_available_voiting (method)">#count_available_voiting</a></span>, <span class='object_link'><a href="ApplicationHelper.html#cp-instance_method" title="ApplicationHelper#cp (method)">#cp</a></span>, <span class='object_link'><a href="ApplicationHelper.html#css_label_status-instance_method" title="ApplicationHelper#css_label_status (method)">#css_label_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_controller_for_navbar%3F-instance_method" title="ApplicationHelper#current_controller_for_navbar? (method)">#current_controller_for_navbar?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage%3F-instance_method" title="ApplicationHelper#current_stage? (method)">#current_stage?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage_controller-instance_method" title="ApplicationHelper#current_stage_controller (method)">#current_stage_controller</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage_for_analytics-instance_method" title="ApplicationHelper#current_stage_for_analytics (method)">#current_stage_for_analytics</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage_popover_status-instance_method" title="ApplicationHelper#current_stage_popover_status (method)">#current_stage_popover_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage_popover_text-instance_method" title="ApplicationHelper#current_stage_popover_text (method)">#current_stage_popover_text</a></span>, <span class='object_link'><a href="ApplicationHelper.html#current_stage_url-instance_method" title="ApplicationHelper#current_stage_url (method)">#current_stage_url</a></span>, <span class='object_link'><a href="ApplicationHelper.html#date_stage_for_project-instance_method" title="ApplicationHelper#date_stage_for_project (method)">#date_stage_for_project</a></span>, <span class='object_link'><a href="ApplicationHelper.html#discontent_style_name-instance_method" title="ApplicationHelper#discontent_style_name (method)">#discontent_style_name</a></span>, <span class='object_link'><a href="ApplicationHelper.html#display_content-instance_method" title="ApplicationHelper#display_content (method)">#display_content</a></span>, <span class='object_link'><a href="ApplicationHelper.html#escape_text-instance_method" title="ApplicationHelper#escape_text (method)">#escape_text</a></span>, <span class='object_link'><a href="ApplicationHelper.html#fast_discussion_able%3F-instance_method" title="ApplicationHelper#fast_discussion_able? (method)">#fast_discussion_able?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#field_for_journal-instance_method" title="ApplicationHelper#field_for_journal (method)">#field_for_journal</a></span>, <span class='object_link'><a href="ApplicationHelper.html#get_check_field%3F-instance_method" title="ApplicationHelper#get_check_field? (method)">#get_check_field?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#get_comment_for_stage-instance_method" title="ApplicationHelper#get_comment_for_stage (method)">#get_comment_for_stage</a></span>, <span class='object_link'><a href="ApplicationHelper.html#get_session_to_work%3F-instance_method" title="ApplicationHelper#get_session_to_work? (method)">#get_session_to_work?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#get_stage_for_improve-instance_method" title="ApplicationHelper#get_stage_for_improve (method)">#get_stage_for_improve</a></span>, <span class='object_link'><a href="ApplicationHelper.html#group_side_name-instance_method" title="ApplicationHelper#group_side_name (method)">#group_side_name</a></span>, <span class='object_link'><a href="ApplicationHelper.html#grouped_discontent%3F-instance_method" title="ApplicationHelper#grouped_discontent? (method)">#grouped_discontent?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#image_for_stages-instance_method" title="ApplicationHelper#image_for_stages (method)">#image_for_stages</a></span>, <span class='object_link'><a href="ApplicationHelper.html#improve_comment-instance_method" title="ApplicationHelper#improve_comment (method)">#improve_comment</a></span>, <span class='object_link'><a href="ApplicationHelper.html#label_approve_stat-instance_method" title="ApplicationHelper#label_approve_stat (method)">#label_approve_stat</a></span>, <span class='object_link'><a href="ApplicationHelper.html#label_discuss_stat-instance_method" title="ApplicationHelper#label_discuss_stat (method)">#label_discuss_stat</a></span>, <span class='object_link'><a href="ApplicationHelper.html#label_for_comment_status-instance_method" title="ApplicationHelper#label_for_comment_status (method)">#label_for_comment_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#label_for_last_time_visit_status-instance_method" title="ApplicationHelper#label_for_last_time_visit_status (method)">#label_for_last_time_visit_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#last_page-instance_method" title="ApplicationHelper#last_page (method)">#last_page</a></span>, <span class='object_link'><a href="ApplicationHelper.html#last_time_visit_aspect-instance_method" title="ApplicationHelper#last_time_visit_aspect (method)">#last_time_visit_aspect</a></span>, <span class='object_link'><a href="ApplicationHelper.html#last_time_visit_journals-instance_method" title="ApplicationHelper#last_time_visit_journals (method)">#last_time_visit_journals</a></span>, <span class='object_link'><a href="ApplicationHelper.html#last_time_visit_page-instance_method" title="ApplicationHelper#last_time_visit_page (method)">#last_time_visit_page</a></span>, <span class='object_link'><a href="ApplicationHelper.html#last_time_visit_post-instance_method" title="ApplicationHelper#last_time_visit_post (method)">#last_time_visit_post</a></span>, <span class='object_link'><a href="ApplicationHelper.html#link_for_aspects-instance_method" title="ApplicationHelper#link_for_aspects (method)">#link_for_aspects</a></span>, <span class='object_link'><a href="ApplicationHelper.html#link_for_improve-instance_method" title="ApplicationHelper#link_for_improve (method)">#link_for_improve</a></span>, <span class='object_link'><a href="ApplicationHelper.html#menu_status-instance_method" title="ApplicationHelper#menu_status (method)">#menu_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#name_controller-instance_method" title="ApplicationHelper#name_controller (method)">#name_controller</a></span>, <span class='object_link'><a href="ApplicationHelper.html#number_stage-instance_method" title="ApplicationHelper#number_stage (method)">#number_stage</a></span>, <span class='object_link'><a href="ApplicationHelper.html#page_for_comment-instance_method" title="ApplicationHelper#page_for_comment (method)">#page_for_comment</a></span>, <span class='object_link'><a href="ApplicationHelper.html#profile%3F-instance_method" title="ApplicationHelper#profile? (method)">#profile?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#rating%3F-instance_method" title="ApplicationHelper#rating? (method)">#rating?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#role_label-instance_method" title="ApplicationHelper#role_label (method)">#role_label</a></span>, <span class='object_link'><a href="ApplicationHelper.html#rowspan_concept-instance_method" title="ApplicationHelper#rowspan_concept (method)">#rowspan_concept</a></span>, <span class='object_link'><a href="ApplicationHelper.html#rowspan_concept_show-instance_method" title="ApplicationHelper#rowspan_concept_show (method)">#rowspan_concept_show</a></span>, <span class='object_link'><a href="ApplicationHelper.html#rowspan_stage-instance_method" title="ApplicationHelper#rowspan_stage (method)">#rowspan_stage</a></span>, <span class='object_link'><a href="ApplicationHelper.html#rowspan_stage_show-instance_method" title="ApplicationHelper#rowspan_stage_show (method)">#rowspan_stage_show</a></span>, <span class='object_link'><a href="ApplicationHelper.html#score_for_concept_field-instance_method" title="ApplicationHelper#score_for_concept_field (method)">#score_for_concept_field</a></span>, <span class='object_link'><a href="ApplicationHelper.html#score_for_plus_post-instance_method" title="ApplicationHelper#score_for_plus_post (method)">#score_for_plus_post</a></span>, <span class='object_link'><a href="ApplicationHelper.html#score_order-instance_method" title="ApplicationHelper#score_order (method)">#score_order</a></span>, <span class='object_link'><a href="ApplicationHelper.html#show_flash-instance_method" title="ApplicationHelper#show_flash (method)">#show_flash</a></span>, <span class='object_link'><a href="ApplicationHelper.html#show_sticker%3F-instance_method" title="ApplicationHelper#show_sticker? (method)">#show_sticker?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#shown_intro-instance_method" title="ApplicationHelper#shown_intro (method)">#shown_intro</a></span>, <span class='object_link'><a href="ApplicationHelper.html#stage_for_essay-instance_method" title="ApplicationHelper#stage_for_essay (method)">#stage_for_essay</a></span>, <span class='object_link'><a href="ApplicationHelper.html#stage_for_essay_link-instance_method" title="ApplicationHelper#stage_for_essay_link (method)">#stage_for_essay_link</a></span>, <span class='object_link'><a href="ApplicationHelper.html#stage_status-instance_method" title="ApplicationHelper#stage_status (method)">#stage_status</a></span>, <span class='object_link'><a href="ApplicationHelper.html#stage_theme-instance_method" title="ApplicationHelper#stage_theme (method)">#stage_theme</a></span>, <span class='object_link'><a href="ApplicationHelper.html#stage_vote%3F-instance_method" title="ApplicationHelper#stage_vote? (method)">#stage_vote?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#status_project-instance_method" title="ApplicationHelper#status_project (method)">#status_project</a></span>, <span class='object_link'><a href="ApplicationHelper.html#trim_content-instance_method" title="ApplicationHelper#trim_content (method)">#trim_content</a></span>, <span class='object_link'><a href="ApplicationHelper.html#type_project-instance_method" title="ApplicationHelper#type_project (method)">#type_project</a></span>, <span class='object_link'><a href="ApplicationHelper.html#type_title-instance_method" title="ApplicationHelper#type_title (method)">#type_title</a></span>, <span class='object_link'><a href="ApplicationHelper.html#unread_expert_news%3F-instance_method" title="ApplicationHelper#unread_expert_news? (method)">#unread_expert_news?</a></span>, <span class='object_link'><a href="ApplicationHelper.html#user_image_tag-instance_method" title="ApplicationHelper#user_image_tag (method)">#user_image_tag</a></span>, <span class='object_link'><a href="ApplicationHelper.html#validate_knowbase-instance_method" title="ApplicationHelper#validate_knowbase (method)">#validate_knowbase</a></span></p>

  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="secret=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="secret-instance_method">
  
    - (<tt>Object</tt>) <strong>secret</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute secret</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_secret'>secret</span>
  <span class='ivar'>@secret</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="secret2=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="secret2-instance_method">
  
    - (<tt>Object</tt>) <strong>secret2</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute secret2</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_secret2'>secret2</span>
  <span class='ivar'>@secret2</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="secret3=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="secret3-instance_method">
  
    - (<tt>Object</tt>) <strong>secret3</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute secret3</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_secret3'>secret3</span>
  <span class='ivar'>@secret3</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="able_concept_posts_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>able_concept_posts_for_vote</strong>(project, disposts, last_vote, num = 0) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 304</span>

<span class='kw'>def</span> <span class='id identifier rubyid_able_concept_posts_for_vote'>able_concept_posts_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_disposts'>disposts</span><span class='comma'>,</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='comma'>,</span> <span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_last_vote'>last_vote</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_concept_post_votings'>concept_post_votings</span><span class='period'>.</span><span class='id identifier rubyid_by_project_votings'>by_project_votings</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='kw'>if</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_dis_post'>dis_post</span> <span class='op'>=</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_discontent_post'>discontent_post</span>
    <span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='id identifier rubyid_disposts'>disposts</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span> <span class='id identifier rubyid_dis_post'>dis_post</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='id identifier rubyid_num'>num</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='int'>0</span> <span class='op'>:</span> <span class='id identifier rubyid_num'>num</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_disposts'>disposts</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='kw'>false</span> <span class='op'>:</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_discontent_post'>discontent_post</span> <span class='op'>=</span> <span class='id identifier rubyid_disposts'>disposts</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_concept_posts'>concept_posts</span> <span class='op'>=</span> <span class='id identifier rubyid_discontent_post'>discontent_post</span><span class='period'>.</span><span class='id identifier rubyid_dispost_concepts'>dispost_concepts</span><span class='period'>.</span><span class='id identifier rubyid_by_status'>by_status</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>concept_posts.id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_concept_posts'>concept_posts</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_discontent_post'>discontent_post</span>
      <span class='kw'>end</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_discontent_post'>discontent_post</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>!=</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_discontent_post_id'>discontent_post_id</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_concept_posts'>concept_posts</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_discontent_post'>discontent_post</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_count_now'>count_now</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_concept_post_votings'>concept_post_votings</span><span class='period'>.</span><span class='id identifier rubyid_by_project_votings'>by_project_votings</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>discontent_post_id:</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_discontent_post_id'>discontent_post_id</span><span class='comma'>,</span> <span class='label'>concept_post_aspect_id:</span> <span class='id identifier rubyid_last_vote'>last_vote</span><span class='period'>.</span><span class='id identifier rubyid_concept_post_aspect_id'>concept_post_aspect_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_concept_posts'>concept_posts</span><span class='lbracket'>[</span><span class='id identifier rubyid_count_now'>count_now</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_discontent_post'>discontent_post</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_score-instance_method">
  
    - (<tt>Object</tt>) <strong>add_score</strong>(h = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_score'>add_score</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='comment'>#@todo нужно добавить project: h[:project]
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='symbol'>:add_life_tape_post</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='symbol'>:plus_comment</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='symbol'>:score_a</span><span class='rparen'>)</span>
      <span class='comment'># self.journals.build(type_event:&#39;useful_comment&#39;, project: h[:project], body:&quot;#{h[:comment].content[0..24]}:#{h[:path]}/#{h[:comment].post.id}#comment_#{h[:comment].id}&quot;).save!
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_comment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:comment</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

    <span class='kw'>when</span> <span class='symbol'>:plus_post</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>25</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Essay</span><span class='op'>::</span><span class='const'>Post</span>
      <span class='comment'># self.add_score_by_type(h[:project], 50, :score_g) if h[:post].instance_of? Concept::Post
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>500</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Plan</span><span class='op'>::</span><span class='const'>Post</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Discontent</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>25</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_discontent</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>25</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span>
          <span class='comment'># comment = &quot;#{get_class_for_improve(h[:post].improve_stage)}::Comment&quot;.constantize.find(h[:post].improve_comment)
</span>          <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_get_comment_for_stage'>get_comment_for_stage</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_stage'>improve_stage</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_discontent_improve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>10</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Concept</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='comment'># self.add_score_by_type(h[:project], h[:post].fullness.nil? ? 40 : h[:post].fullness + 39, :score_g)
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>50</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>50</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span>
          <span class='comment'># comment = &quot;#{get_class_for_improve(h[:post].improve_stage)}::Comment&quot;.constantize.find(h[:post].improve_comment)
</span>          <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_get_comment_for_stage'>get_comment_for_stage</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_stage'>improve_stage</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept_improve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>20</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='comment'># self.add_score_by_type(h[:project], 10, :score_g) if h[:post].instance_of? CollectInfo::Post
</span>    <span class='kw'>when</span> <span class='symbol'>:plus_field</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Concept</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='comment'># self.add_score_by_type(h[:project], h[:post].fullness.nil? ? 40 : h[:post].fullness + 39, :score_g)
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_score_for_concept_field'>score_for_concept_field</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_score_for_concept_field'>score_for_concept_field</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_content</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_status_name'>status_name</span> <span class='kw'>and</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_status_content'>status_content</span>
            <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>40</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbol'>:plus_field_all</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Concept</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='int'>40</span> <span class='op'>:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_journals'>journals</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>type_event:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>user_informed:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>body:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='int'>40</span> <span class='op'>:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>first_id:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>body2:</span> <span class='id identifier rubyid_trim_content'>trim_content</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>viewed:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>personal:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbol'>:to_archive_life_tape_post</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='symbol'>:add_discontent_post</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='symbol'>:to_archive_plus_comment</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>5</span><span class='comma'>,</span> <span class='symbol'>:score_a</span><span class='rparen'>)</span>
      <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_destroy_journal_record'>destroy_journal_record</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_comment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:comment</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='symbol'>:to_archive_plus_post</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='id identifier rubyid_score_for_plus_post'>score_for_plus_post</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Discontent</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_destroy_journal_record'>destroy_journal_record</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_discontent</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span>
          <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='id identifier rubyid_get_comment_for_stage'>get_comment_for_stage</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_stage'>improve_stage</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_improve_comment'>improve_comment</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
          <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_destroy_journal_record'>destroy_journal_record</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_discontent_improve</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

    <span class='kw'>when</span> <span class='symbol'>:to_archive_plus_field</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='id identifier rubyid_score_for_concept_field'>score_for_concept_field</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Concept</span><span class='op'>::</span><span class='const'>Post</span> <span class='kw'>and</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_name</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_content</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:type_field</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_destroy_journal_record'>destroy_journal_record</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='symbol'>:to_archive_plus_field_all</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='int'>40</span> <span class='op'>:</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_fullness'>fullness</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'>Concept</span><span class='op'>::</span><span class='const'>Post</span>
        <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_destroy_journal_record'>destroy_journal_record</span><span class='lparen'>(</span><span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:project</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_add_score_concept</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_score_by_type-instance_method">
  
    - (<tt>Object</tt>) <strong>add_score_by_type</strong>(project, score, type = :score_g) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 271</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_score_by_type'>add_score_by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_score'>score</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='symbol'>:score_g</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ps'>ps</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_core_project_scores'>core_project_scores</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first_or_create'>first_or_create</span>
  <span class='id identifier rubyid_ps'>ps</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>score:</span> <span class='id identifier rubyid_score'>score</span> <span class='op'>+</span><span class='id identifier rubyid_ps'>ps</span><span class='period'>.</span><span class='id identifier rubyid_score'>score</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ps'>ps</span><span class='period'>.</span><span class='id identifier rubyid_read_attribute'>read_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='op'>+</span><span class='id identifier rubyid_score'>score</span><span class='rparen'>)</span>
  <span class='const'>Award</span><span class='period'>.</span><span class='id identifier rubyid_reward'>reward</span><span class='lparen'>(</span><span class='label'>user:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>old_score:</span> <span class='id identifier rubyid_ps'>ps</span><span class='period'>.</span><span class='id identifier rubyid_score'>score</span><span class='op'>-</span><span class='id identifier rubyid_score'>score</span><span class='comma'>,</span> <span class='label'>project:</span> <span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='label'>score:</span> <span class='id identifier rubyid_ps'>ps</span><span class='period'>.</span><span class='id identifier rubyid_score'>score</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>max</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='comment'># self.user_project_scores(project).update_attributes!(score: score+self.score, type =&gt; self.read_attribute(type)+score)
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="admin?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>admin?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_admin?'>admin?</span>
  <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="answered_for_help_stage?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>answered_for_help_stage?</strong>(stage) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 109</span>

<span class='kw'>def</span> <span class='id identifier rubyid_answered_for_help_stage?'>answered_for_help_stage?</span><span class='lparen'>(</span><span class='id identifier rubyid_stage'>stage</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_help_posts'>help_posts</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:stage</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_stage'>stage</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="aspects-instance_method">
  
    - (<tt>Object</tt>) <strong>aspects</strong>(id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_aspects'>aspects</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_core_aspects'>core_aspects</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'>Core</span><span class='op'>::</span><span class='const'>Aspect</span><span class='op'>::</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>project_id:</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_core_aspects'>core_aspects</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="aspects_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>aspects_for_vote</strong>(project, status) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>аспекты для голосования (необходимые, важные, неважные)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


379
380
381</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 379</span>

<span class='kw'>def</span> <span class='id identifier rubyid_aspects_for_vote'>aspects_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_voted_aspects'>voted_aspects</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>collect_info_votings:</span> <span class='lbrace'>{</span><span class='label'>status:</span> <span class='id identifier rubyid_status'>status</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="boss?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>boss?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>REF remove methods  - for dinamic methods</p>
</div>
  </div>



  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_boss?'>boss?</span>
  <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="can_edit_project?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>can_edit_project?</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


353
354
355
356
357</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 353</span>

<span class='kw'>def</span> <span class='id identifier rubyid_can_edit_project?'>can_edit_project?</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='comment'>#@todo нужно мигрировать все данные всех проектов
</span>  <span class='kw'>true</span>
  <span class='comment'>#project.project_users.by_type(1).include?(self) || project.project_users.by_type(0).include?(self)
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="can_vote_for-instance_method">
  
    - (<tt>Object</tt>) <strong>can_vote_for</strong>(stage, project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 278</span>

<span class='kw'>def</span> <span class='id identifier rubyid_can_vote_for'>can_vote_for</span><span class='lparen'>(</span><span class='id identifier rubyid_stage'>stage</span><span class='comma'>,</span> <span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_stage'>stage</span> <span class='op'>==</span> <span class='symbol'>:collect_info</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='int'>2</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_get_free_votes_for'>get_free_votes_for</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>collect_info</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_stage'>stage</span> <span class='op'>==</span> <span class='symbol'>:discontent</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='int'>6</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_get_free_votes_for'>get_free_votes_for</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>discontent</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_stage'>stage</span> <span class='op'>==</span> <span class='symbol'>:concept</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='int'>8</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_get_free_votes_for'>get_free_votes_for</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>concept</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_stage'>stage</span> <span class='op'>==</span> <span class='symbol'>:novation</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='int'>10</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_get_free_votes_for'>get_free_votes_for</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>novation</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
    <span class='comment'># disposts = Discontent::Post.where(project_id: project, status: 4).order(:id)
</span>    <span class='comment'># last_vote = self.concept_post_votings.by_project_votings(project).last
</span>    <span class='comment'># return true if last_vote.nil?
</span>    <span class='comment'># dispost = self.able_concept_posts_for_vote(project, disposts, last_vote)
</span>    <span class='comment'># if dispost
</span>    <span class='comment'>#   concept_posts = dispost.dispost_concepts.by_status(0).order(&#39;concept_posts.id&#39;)
</span>    <span class='comment'>#   count_now = self.concept_post_votings.by_project_votings(project).where(discontent_post_id: last_vote.discontent_post_id, concept_post_aspect_id: last_vote.concept_post_aspect_id).count
</span>    <span class='comment'>#   unless concept_posts[dispost.id != last_vote.discontent_post_id ? 0 : count_now].nil?
</span>    <span class='comment'>#     return true
</span>    <span class='comment'>#   end
</span>    <span class='comment'># end
</span>  <span class='kw'>elsif</span> <span class='id identifier rubyid_stage'>stage</span> <span class='op'>==</span> <span class='symbol'>:estimate</span> <span class='kw'>and</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>==</span> <span class='int'>11</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_voted_plan_posts'>voted_plan_posts</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cluber?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>cluber?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 143</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cluber?'>cluber?</span>
  <span class='lbracket'>[</span><span class='int'>4</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="concepts_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>concepts_for_vote</strong>(project, status) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>идеи для голосования (да, нет)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


401
402
403</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 401</span>

<span class='kw'>def</span> <span class='id identifier rubyid_concepts_for_vote'>concepts_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_voted_concept_post'>voted_concept_post</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>concept_votings:</span> <span class='lbrace'>{</span><span class='label'>status:</span> <span class='id identifier rubyid_status'>status</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="content_for_project-instance_method">
  
    - (<tt>Object</tt>) <strong>content_for_project</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


422
423
424
425
426
427
428</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 422</span>

<span class='kw'>def</span> <span class='id identifier rubyid_content_for_project'>content_for_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_current_stage_values'>current_stage_values</span><span class='lbracket'>[</span><span class='symbol'>:type_stage</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>LIST_STAGES</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_second'>second</span><span class='lbracket'>[</span><span class='symbol'>:type_stage</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_core_aspects'>core_aspects</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_current_stage_values'>current_stage_values</span><span class='lbracket'>[</span><span class='symbol'>:type_stage</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_for_project'>for_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_projects_for_journal-instance_method">
  
    - (<tt>Object</tt>) <strong>current_projects_for_journal</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_projects_for_journal'>current_projects_for_journal</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_prime_admin?'>prime_admin?</span>
    <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_active_proc'>active_proc</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_opened_projects'>opened_projects</span> <span class='op'>=</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_active_proc'>active_proc</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:opened</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_club_projects'>club_projects</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cluber?'>cluber?</span> <span class='kw'>or</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_boss?'>boss?</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_active_proc'>active_proc</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:club</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_closed_projects'>closed_projects</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_projects'>projects</span><span class='period'>.</span><span class='id identifier rubyid_active_proc'>active_proc</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>core_projects:</span> <span class='lbrace'>{</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:closed</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_projects'>projects</span> <span class='op'>=</span> <span class='id identifier rubyid_opened_projects'>opened_projects</span> <span class='op'>|</span> <span class='id identifier rubyid_club_projects'>club_projects</span> <span class='op'>|</span> <span class='id identifier rubyid_closed_projects'>closed_projects</span>
    <span class='id identifier rubyid_projects'>projects</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>-</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_projects_for_user-instance_method">
  
    - (<tt>Object</tt>) <strong>current_projects_for_user</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>REF remove security methods to projectUsers</p>
</div>
  </div>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_projects_for_user'>current_projects_for_user</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_prime_admin?'>prime_admin?</span>
    <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_opened_projects'>opened_projects</span> <span class='op'>=</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:opened</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_club_projects'>club_projects</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cluber?'>cluber?</span> <span class='kw'>or</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_boss?'>boss?</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:club</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_closed_projects'>closed_projects</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_projects'>projects</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>core_projects:</span> <span class='lbrace'>{</span><span class='label'>type_access:</span> <span class='const'>Core</span><span class='op'>::</span><span class='const'>Project</span><span class='op'>::</span><span class='const'>TYPE_ACCESS_CODE</span><span class='lbracket'>[</span><span class='symbol'>:closed</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_projects'>projects</span> <span class='op'>=</span> <span class='id identifier rubyid_opened_projects'>opened_projects</span> <span class='op'>|</span> <span class='id identifier rubyid_club_projects'>club_projects</span> <span class='op'>|</span> <span class='id identifier rubyid_closed_projects'>closed_projects</span>
    <span class='id identifier rubyid_projects'>projects</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>-</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="discontents_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>discontents_for_vote</strong>(project, status) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>несовершенства для голосования (необходимые, важные, неважные)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 390</span>

<span class='kw'>def</span> <span class='id identifier rubyid_discontents_for_vote'>discontents_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_voted_discontent_posts'>voted_discontent_posts</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>discontent_votings:</span> <span class='lbrace'>{</span><span class='label'>status:</span> <span class='id identifier rubyid_status'>status</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expert?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>expert?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expert?'>expert?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>2</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="group_include_user?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>group_include_user?</strong>(user) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


359
360
361
362
363
364</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 359</span>

<span class='kw'>def</span> <span class='id identifier rubyid_group_include_user?'>group_include_user?</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_groups'>groups</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group'>group</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_group'>group</span><span class='period'>.</span><span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="have_essay_for_stage-instance_method">
  
    - (<tt>Object</tt>) <strong>have_essay_for_stage</strong>(project, stage) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_have_essay_for_stage'>have_essay_for_stage</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_stage'>stage</span><span class='rparen'>)</span>
  <span class='op'>!</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_essay_posts'>essay_posts</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>project_id:</span> <span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='label'>stage:</span> <span class='id identifier rubyid_stage'>stage</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="jury?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>jury?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_jury?'>jury?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>3</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="last_event-instance_method">
  
    - (<tt>Object</tt>) <strong>last_event</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_last_event'>last_event</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_last_event_for'>last_event_for</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="looked_chat-instance_method">
  
    - (<tt>Object</tt>) <strong>looked_chat</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


345
346
347</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 345</span>

<span class='kw'>def</span> <span class='id identifier rubyid_looked_chat'>looked_chat</span>
  <span class='id identifier rubyid_update_attributes!'>update_attributes!</span> <span class='label'>last_seen_chat_at:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="moderator_in_project?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>moderator_in_project?</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 349</span>

<span class='kw'>def</span> <span class='id identifier rubyid_moderator_in_project?'>moderator_in_project?</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_project_users'>project_users</span><span class='period'>.</span><span class='id identifier rubyid_by_type'>by_type</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="my_journals-instance_method">
  
    - (<tt>Object</tt>) <strong>my_journals</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_my_journals'>my_journals</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_events'>events</span> <span class='op'>=</span> <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_events_for_my_feed'>events_for_my_feed</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_g'>g</span> <span class='op'>=</span> <span class='id identifier rubyid_events'>events</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_first_id'>first_id</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_type_event'>type_event</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="my_journals_viewed-instance_method">
  
    - (<tt>Object</tt>) <strong>my_journals_viewed</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


338
339
340
341
342</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_my_journals_viewed'>my_journals_viewed</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_events'>events</span> <span class='op'>=</span> <span class='const'>Journal</span><span class='period'>.</span><span class='id identifier rubyid_events_for_my_feed_viewed'>events_for_my_feed_viewed</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_g'>g</span> <span class='op'>=</span> <span class='id identifier rubyid_events'>events</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_first_id'>first_id</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_type_event'>type_event</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="not_ready_for_concept?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>not_ready_for_concept?</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372
373
374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 370</span>

<span class='kw'>def</span> <span class='id identifier rubyid_not_ready_for_concept?'>not_ready_for_concept?</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_project_user_for'>project_user_for</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>false</span>
  <span class='kw'>else</span>
    <span class='op'>!</span><span class='id identifier rubyid_project_user_for'>project_user_for</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ready_to_concept'>ready_to_concept</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="novations_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>novations_for_vote</strong>(project, status) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>пакеты для голосования (да, нет)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 412</span>

<span class='kw'>def</span> <span class='id identifier rubyid_novations_for_vote'>novations_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_voted_novation_post'>voted_novation_post</span><span class='period'>.</span><span class='id identifier rubyid_by_project'>by_project</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>novation_votings:</span> <span class='lbrace'>{</span><span class='label'>status:</span> <span class='id identifier rubyid_status'>status</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="plan_vote_status-instance_method">
  
    - (<tt>Object</tt>) <strong>plan_vote_status</strong>(post, type) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


430
431
432</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 430</span>

<span class='kw'>def</span> <span class='id identifier rubyid_plan_vote_status'>plan_vote_status</span><span class='lparen'>(</span><span class='id identifier rubyid_post'>post</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_plan_post_votings'>plan_post_votings</span><span class='period'>.</span><span class='id identifier rubyid_by_post'>by_post</span><span class='lparen'>(</span><span class='id identifier rubyid_post'>post</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_by_type'>by_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:status</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prime_admin?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>prime_admin?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prime_admin?'>prime_admin?</span>
  <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="project_user_for-instance_method">
  
    - (<tt>Object</tt>) <strong>project_user_for</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


366
367
368</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 366</span>

<span class='kw'>def</span> <span class='id identifier rubyid_project_user_for'>project_user_for</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_core_project_users'>core_project_users</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>project_id:</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="role_expert?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>role_expert?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_role_expert?'>role_expert?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_role_stat'>role_stat</span> <span class='op'>==</span> <span class='int'>2</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="role_name-instance_method">
  
    - (<tt>Object</tt>) <strong>role_name</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 121</span>

<span class='kw'>def</span> <span class='id identifier rubyid_role_name'>role_name</span>
  <span class='kw'>if</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>6</span><span class='comma'>,</span> <span class='int'>7</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>модератор</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>2</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>эксперт</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>3</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>жюри</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stat_expert?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>stat_expert?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stat_expert?'>stat_expert?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_role_stat'>role_stat</span> <span class='op'>==</span> <span class='int'>3</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_anonym'>anonym</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_nickname'>nickname</span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_surname'>surname</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="uniq_proc_access?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>uniq_proc_access?</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 133</span>

<span class='kw'>def</span> <span class='id identifier rubyid_uniq_proc_access?'>uniq_proc_access?</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_moderator_id'>moderator_id</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_moderator_id'>moderator_id</span> <span class='op'>==</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='kw'>or</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>7</span><span class='rparen'>)</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unvote_aspects_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>unvote_aspects_for_vote</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>аспекты за которые пользователь еще не проголосовал</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


384
385
386
387</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 384</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unvote_aspects_for_vote'>unvote_aspects_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_vote_aspects'>vote_aspects</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_proc_main_aspects'>proc_main_aspects</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:final_votings</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>collect_info_votings:</span> <span class='lbrace'>{</span><span class='label'>user_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core_aspect_posts.id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_proc_main_aspects'>proc_main_aspects</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_vote_aspects'>vote_aspects</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unvote_concepts_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>unvote_concepts_for_vote</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>идеи за которые пользователь еще не проголосовал</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


406
407
408
409</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 406</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unvote_concepts_for_vote'>unvote_concepts_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_vote_concepts'>vote_concepts</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_concept_ongoing_post'>concept_ongoing_post</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:final_votings</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>concept_votings:</span> <span class='lbrace'>{</span><span class='label'>user_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>concept_posts.id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_concept_ongoing_post'>concept_ongoing_post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_vote_concepts'>vote_concepts</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unvote_discontents_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>unvote_discontents_for_vote</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>несовершенства за которые пользователь еще не проголосовал</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


395
396
397
398</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 395</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unvote_discontents_for_vote'>unvote_discontents_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_vote_discontents'>vote_discontents</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_discontent_for_vote'>discontent_for_vote</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:final_votings</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>discontent_votings:</span> <span class='lbrace'>{</span><span class='label'>user_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>discontent_posts.id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_discontent_for_vote'>discontent_for_vote</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_vote_discontents'>vote_discontents</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unvote_novations_for_vote-instance_method">
  
    - (<tt>Object</tt>) <strong>unvote_novations_for_vote</strong>(project) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>пакеты за которые пользователь еще не проголосовал</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


417
418
419
420</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 417</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unvote_novations_for_vote'>unvote_novations_for_vote</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_vote_novations'>vote_novations</span> <span class='op'>=</span> <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_novations'>novations</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:final_votings</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>novation_votings:</span> <span class='lbrace'>{</span><span class='label'>user_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>novation_posts.id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_project'>project</span><span class='period'>.</span><span class='id identifier rubyid_novations'>novations</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_vote_novations'>vote_novations</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user_project_scores-instance_method">
  
    - (<tt>Object</tt>) <strong>user_project_scores</strong>(project) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 105</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user_project_scores'>user_project_scores</span><span class='lparen'>(</span><span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_core_project_scores'>core_project_scores</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core_project_scores.project_id = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_project'>project</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_password?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>valid_password?</strong>(password) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_password?'>valid_password?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>InvalidHash</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_password'>password</span> <span class='op'>==</span> <span class='id identifier rubyid_encrypted_password'>encrypted_password</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_email'>email</span><span class='embexpr_end'>}</span><span class='tstring_content'> is using the old password hashing method, updating attribute.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_password'>password</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="watcher?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>watcher?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_watcher?'>watcher?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type_user'>type_user</span> <span class='op'>==</span> <span class='int'>5</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed May 13 15:35:10 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>

  </body>
</html>